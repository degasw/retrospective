"use strict";angular.module("retrospectiveApp",["ngCookies","ngResource","ngSanitize","ngRoute"]).config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"partials/main",controller:"MainCtrl"}).when("/issues/new",{templateUrl:"partials/issues/new",controller:"IssuesCtrl"}).when("/issues/list",{templateUrl:"partials/issues/list",controller:"IssuesCtrl"}).when("/issues/proposals",{templateUrl:"partials/issues/proposal",controller:"ProposalsCtrl"}).when("/reports",{templateUrl:"partials/reports/ranking",controller:"ReportsCtrl"}).when("/issues/confirm",{templateUrl:"partials/issues/confirm",controller:"VotesCtrl"}).otherwise({redirectTo:"/"}),b.html5Mode(!0)}]),angular.module("retrospectiveApp").controller("MainCtrl",["$scope","$http",function(a,b){b.get("/api/awesomeThings").success(function(b){a.awesomeThings=b})}]),angular.module("retrospectiveApp").controller("NavbarCtrl",["$scope","$location",function(a,b){a.menu=[{title:"Home",link:"/"},{title:"Issues",link:"/issues/list"},{title:"Reports",link:"/reports"}],a.isActive=function(a){return a===b.path()}}]),angular.module("retrospectiveApp").controller("IssuesCtrl",["$scope","$http","$location","IssueService","VotesService",function(a,b,c,d,e){a.init=function(){a.voteList=[],a.voteSubmitted=!1,f()};var f=function(){d.list().success(function(b){a.issues=b}).error(function(a){console.log(a)})};a.cancel=function(){a.voteSubmitted=!1,c.url("/")},a.create=function(){b.post("/api/issue",{issue:a.issue}).success(function(){c.url("/issues/list")}).error(function(a){console.log(a)})},a.addToVoteList=function(b){_.contains(a.voteList,b._id)&&_.remove(a.voteList,b._id),a.voteList.push(b)},a.submitVotes=function(){e.add(a.voteList),a.voteSubmitted=!0,c.url("/issues/confirm")}}]),angular.module("retrospectiveApp").controller("ProposalsCtrl",["$scope","$location","ProposalService",function(a,b,c){a.init=function(){a.vote=c.get()};var d=function(){a.proposal=""},e=function(){b.url("/reports")};a.add=function(){a.vote.proposals.push(a.proposal),d()},a.done=function(){c.set(a.vote),c.update(),e()},a.cancel=function(){e()},a.init()}]),angular.module("retrospectiveApp").controller("ReportsCtrl",["$scope","$http","$location","ProposalService",function(a,b,c,d){a.init=function(){b.get("/api/reports/ranking").success(function(b){a.votes=b}).error(function(a){console.log(a)})},a.viewProposals=function(a){d.setIssue(a.issue),c.url("/issues/proposals")},a.cancel=function(){c.url("/")},a.init()}]),angular.module("retrospectiveApp").controller("VotesCtrl",["$scope","$location","VotesService","IssueService",function(a,b,c){function d(){a.voteList=c.list()}a.init=function(){a.voteSaved=!1,d()},a.saveVotes=function(){c.save().then(function(){a.voteSaved=!0,console.log(a.voteSaved)})},a.cancel=function(){b.url("/issues/list")},a.init()}]),angular.module("retrospectiveApp").factory("IssueService",["$http",function(a){var b={};return{get:function(){return b},set:function(a){b=a},update:function(){a.put("/api/issue",{issue:b}).success(function(){}).error(function(a){console.log(a)})},list:function(){return a.get("/api/issue")}}}]),angular.module("retrospectiveApp").factory("VotesService",["$http",function(a){var b;return{add:function(a){b=a},list:function(){return b},save:function(){return a.post("/api/vote",{issues:b})}}}]),angular.module("retrospectiveApp").factory("ProposalService",["$http",function(a){var b={},c=function(){a.post("/api/proposal",{vote:b}).success(function(a){"null"!==a&&(b.issue=a.issue,b.proposals=a.proposals)}).error(function(a){console.log(a)})};return{get:function(){return c(),b},setIssue:function(a){b.issue=a,b.proposals=[]},set:function(a){b=a},update:function(){a.put("/api/proposal",{vote:b}).success(function(){}).error(function(a){console.log(a)})}}}]);